<!DOCTYPE HTML>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Aerohive Children Day</title>

	<style type="text/css">
		*{margin : 0; padding: 0;}
		body{font: 12px/1.5 arial;}

		.section{width : 1000px; margin : 0 auto; padding : 40px}
		.section-lf{width : 300px; float : left;}
		.section-rt{overflow:hidden}
	</style>
</head>
<body>

	<div id="wrapper">

		<div class="section section-1">
			<div class="section-lf">Child Photo</div>
			<div class="section-rt">
				<div>
					<img src="1.jpg" alt="" />
					<img src="1.jpg" alt="" />
				</div>
				<div>
					<img src="1.jpg" alt="" />
					<img src="1.jpg" alt="" />
				</div>
			</div>
		</div>

		<button id="next">Next</button>

	</div>

	<script src="http://lib.sinaapp.com/js/jquery/1.9.1/jquery-1.9.1.min.js"></script>

	<script type="text/javascript">
		(function(){
			var n = 170, m = 40,
				topics = 16, checks = 4, per = topics/checks;

			return {

				step : 0,

				_ret : [],

				_startTime : +new Date(),

				init : function(){
					
					this._prepare();		

					this._rendUI();
					this._bindUI();
				},

				_prepare : function(){
					var dd, dt, arr;

					this.employee = this._makeArr(n);
					this.children = this._makeArr(m);

					arr = this.usedChildren = this._makeRandomArr(this.children, topics);

					console.log(this.usedChildren);

					for(var i = 0; i < checks; i++){
						dd = this._ret[i] = [];
						for(var j = 0; j < per; j++){
							dt = dd[j] = [];
							dt.push(arr[0]);
							dd[j] = dt.concat(this._makeMatchEmployee(arr[0],i));
							arr.splice(0,1);
						}
					}

					console.log(this._ret);

				},

				_rendUI : function(){
					this.setStep(this.step);	  
				},

				_bindUI : function(){
					$('#wrapper').on('click', '#next', $.proxy(this._handleClickBtn, this));
				},

				goNext : function(){
					this.step++;		 

					this.setStep(this.step);
				},

				setStep : function(num){
					var arr = this._ret[num];		  

					
				},

				_handleClickBtn : function(e){
					if(this.step >= 3){
						//$.post('',data).done();				  
					}else{
						this.goNext();
					}			  
				},

				_makeArr : function(n){
					var arr = [];

					for(var i = 0; i < n; i++){
						arr.push(i);
					}

					return arr;
				},

				_makeRandomArr : function(arr, k){
					var i = 0, ret = [], j;
				 	for(; i < k; i++){
						j = Math.floor(Math.random()*arr.length);				 
						ret.push(arr[j]);
						arr.splice(j, 1);
					}				 

					return ret;
				},

				_makeMatchEmployee : function(child, j){
					var i = 4,
						num = i + j * 2,
						arr;

					this.employee.splice(this.employee.indexOf(child), 1);

					arr = this._makeRandomArr(this.employee, num - 1);

					arr.splice(Math.floor(Math.random()*arr.length), 0, child);

					console.log(arr);

					return arr;
			 	}

			};
			
 		})().init();
	</script>
</body>
</html>
